#-------------------------------------------------------------------------------
#---Package import--------------------------------------------------------------
#-------------------------------------------------------------------------------
#---Detaching packages
detach("package:Chem", unload = TRUE)

#---Loading needed packages
if(!require("devtools")) {
  install.packages("devtools")
  library("devtools")
}
install_github("gindeanikita/Chem", force = TRUE)
library(Chem)

#-------------------------------------------------------------------------------
#---Function testing: TransformChemData-----------------------------------------
#-------------------------------------------------------------------------------
nSMILES <- "CN(CC1=CN=C2C(=N1)C(=NC(=N2)N)N)C3=CC=C(C=C3)C(=O)N[C@@H](CCC(=O)O)C(=O)O"
nSMILES2Mol <- Chem::TransformChemData(nSMILES, "smiles", "mol")
ChemmineR::draw_sdf(nSMILES2Mol[[1]])

#-------------------------------------------------------------------------------
#---Function testing: ImportSDF-------------------------------------------------
#-------------------------------------------------------------------------------
setwd("C:/Users/ginde/OneDrive - IQS/IQS/Año 4/TFG - Trabajo de Fin de Grado/R test")
dfSDFImport <- ChemmineR::read.SDFstr("CMP.sdf")

setwd("C:/Users/ginde/OneDrive - IQS/IQS/Año 4/TFG - Trabajo de Fin de Grado/R test/MolExport")
ChemmineR::write.SDFsplit(x=dfSDFImport, filetag="myfile", nmol=1)

dfSDFImport_List <- Chem::ImportSDF("list",
                                   c("myfile01_01.sdf", "myfile02_02.sdf",
                                     "myfile03_03.sdf", "myfile04_04.sdf"))

dfSDFImport_setwd <- Chem::ImportSDF("directory")

#-------------------------------------------------------------------------------
#---Function testing: DrawMolecule----------------------------------------------
#-------------------------------------------------------------------------------
Chem::DrawMolecule("sdf",dfSDFImport_setwd,1,"test")
#There is an error, maybe in case it is importing a SDFstr, assign it to another
#SDFstr inside the function in order to operate it correctly.
