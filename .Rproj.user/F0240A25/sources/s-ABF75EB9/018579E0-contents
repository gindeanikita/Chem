#-------------------------------------------------------------------------------
#---Package import--------------------------------------------------------------
#-------------------------------------------------------------------------------
#---Detaching packages
detach("package:Chem", unload = TRUE)

#---Loading needed packages
if(!require("devtools")) {
  install.packages("devtools")
  library("devtools")
}
install_github("gindeanikita/Chem", force = TRUE)
library(Chem)

#-------------------------------------------------------------------------------
#---Function testing: TransformChemData-----------------------------------------
#-------------------------------------------------------------------------------
nSMILES <- "CN(CC1=CN=C2C(=N1)C(=NC(=N2)N)N)C3=CC=C(C=C3)C(=O)N[C@@H](CCC(=O)O)C(=O)O"
nSMILES2Mol <- Chem::TransformChemData(nSMILES, "smiles", "mol")
ChemmineR::draw_sdf(nSMILES2Mol[[1]])

#-------------------------------------------------------------------------------
#---Function testing: ImportSDF-------------------------------------------------
#-------------------------------------------------------------------------------
setwd("C:/Users/ginde/OneDrive - IQS/IQS/Año 4/TFG - Trabajo de Fin de Grado/R test")
dfSDFImport <- ChemmineR::read.SDFstr("CMP.sdf")

setwd("C:/Users/ginde/OneDrive - IQS/IQS/Año 4/TFG - Trabajo de Fin de Grado/R test/MolExport")
ChemmineR::write.SDFsplit(x=dfSDFImport, filetag="myfile", nmol=1)

dfSDFImport_List <- Chem::ImportSDF("list",
                                   c("myfile01_01.sdf", "myfile02_02.sdf",
                                     "myfile03_03.sdf", "myfile04_04.sdf"))

dfSDFImport_setwd <- Chem::ImportSDF("directory")

ChemmineR::draw_sdf(dfSDFImport_List@SDF[[2]]@SDF[[1]])

a <- new("SDFset")
files <- c("myfile01_01.sdf", "myfile02_02.sdf", "myfile03_03.sdf",
           "myfile04_04.sdf")
x <- 1
for(val in files){
  a[[x]] <- ChemmineR::read.SDFset(val)
  x <- x + 1
}
str1 <- "List imported with "
str2 <- toString(x - 1)
str3 <- " files."
print(paste(str1, str2, str3))
