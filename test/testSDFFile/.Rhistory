#-------------------------------------------------------------------------------
#---Package import--------------------------------------------------------------
#-------------------------------------------------------------------------------
#---Detaching packages
detach("package:Chem", unload = TRUE)
#---Loading needed packages
if(!require("devtools")) {
install.packages("devtools")
library("devtools")
}
install_github("gindeanikita/Chem", force = TRUE)
library(Chem)
#-------------------------------------------------------------------------------
#---Function testing: distanceCalculator----------------------------------------
#-------------------------------------------------------------------------------
chName <- c("methotrexate", "aspirin", "aminopterin", "pralatrexate",
"methyl salicylate", "ethyl salicylate")
chStr <- c("InChI=1S/C20H22N8O5/c1-28(9-11-8-23-17-15(24-11)16(21)26-20(22)27-17)12-4-2-10(3-5-12)18(31)25-13(19(32)33)6-7-14(29)30/h2-5,8,13H,6-7,9H2,1H3,(H,25,31)(H,29,30)(H,32,33)(H4,21,22,23,26,27)/t13-/m0/s1",
"InChI=1S/C9H8O4/c1-6(10)13-8-5-3-2-4-7(8)9(11)12/h2-5H,1H3,(H,11,12)",
"InChI=1S/C19H20N8O5/c20-15-14-16(27-19(21)26-15)23-8-11(24-14)7-22-10-3-1-9(2-4-10)17(30)25-12(18(31)32)5-6-13(28)29/h1-4,8,12,22H,5-7H2,(H,25,30)(H,28,29)(H,31,32)(H4,20,21,23,26,27)/t12-/m0/s1",
"InChI=1S/C23H23N7O5/c1-2-3-14(10-15-11-26-20-18(27-15)19(24)29-23(25)30-20)12-4-6-13(7-5-12)21(33)28-16(22(34)35)8-9-17(31)32/h1,4-7,11,14,16H,3,8-10H2,(H,28,33)(H,31,32)(H,34,35)(H4,24,25,26,29,30)/t14?,16-/m0/s1",
"InChI=1S/C8H8O3/c1-11-8(10)6-4-2-3-5-7(6)9/h2-5,9H,1H3",
"InChI=1S/C9H10O3/c1-2-12-9(11)7-5-3-4-6-8(7)10/h3-6,10H,2H2,1H3")
calcMethod = "tanimoto"
distanceCalculator(chName, chStr, calcMethod)
?cs_check_key()
edit_r_environ()
edit_r_profile()
distanceCalculator(chName, chStr, calcMethod)
?cs_check_key()
cs_check_key()
webchem::cs_check_key()
edit_r_environ()
edit_r_profile()
install.packages(c("igraph", "rsvg", "vctrs"))
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
library(BiocManager)
BiocManager::install(version='devel')
BiocManager::install("ChemmineOB")
BiocManager::install("ChemmineOB")
BiocManager::install("ChemmineOB")
#-------------------------------------------------------------------------------
#--- Loading and installing required packages
if (!require("devtools")) {
install.packages("devtools")
library(devtools)
}
install.packages("devtools")
install.packages("rcdklibs")
wininet
install.packages("rJava")
install.packages("rcdk")
BiocManager::install("ChemmineR")
BiocManager::install("MASS")
BiocManager::install("ChemmineR")
BiocManager::install("ChemmineOB")
BiocManager::install("ChemmineOB")
BiocManager::install(version = "3.14")
BiocManager::install("ChemmineOB")
library(BiocManager)
install("ChemmineOB", version = "1.32.0")
install("ChemmineOB", version = "3.14")
library(Chem)
#-------------------------------------------------------------------------------
#--- Loading and installing required packages
if (!require("devtools")) {
install.packages("devtools")
library(devtools)
}
install_github("gindeanikita/Chem", force = TRUE)
library(Chem)
library(Chem)
library(Chem)
install_github("gindeanikita/Chem", force = TRUE)
#-------------------------------------------------------------------------------
#--- Loading and installing required packages
if (!require("devtools")) {
install.packages("devtools")
library(devtools)
}
install_github("gindeanikita/Chem", force = TRUE)
install.packages("cli")
install.packages("cli")
install.packages("cli")
install.packages("cli")
library(rcdklibs)
library(rcdk)
#-------------------------------------------------------------------------------
#--- Loading and installing required packages
if (!require("devtools")) {
install.packages("devtools")
library(devtools)
}
install_github("gindeanikita/Chem", force = TRUE)
library(Chem)
library(rJava)
library(rcdklibs)
library(rcdk)
library(ChemmineOB)
library(ChemmineR)
setwd("C:/Users/ginde/OneDrive - IQS/IQS/AÃ±o 4/TFG - Trabajo de Fin de Grado/Chem/test/testSDFFile")
#-------------------------------------------------------------------------------
#--- Correcting the file and importing it afterwards
sdfAdjusted <- sdfAdjust(sdfFile = "CMP_misswritten.sdf", directory = getwd(),
saveNewFile = TRUE, newFileName = "CMP_corrected.sdf")
dfCMP_crr_rcdk <- load.molecules("CMP_corrected.sdf")
dfCMP_crr_CheR <- read.SDFset("CMP_corrected.sdf")
dfCMP_crr_CheR_fps <- data.frame(Molecule = rep(1:24))
for (i in 1:length(dfCMP_crr_CheR)) {
dfCMP_crr_CheR_fps$fps[i] <- paste(
as.character(fingerprintOB(dfCMP_crr_CheR[i], "FP2")@fpma), collapse = "")
}
detach("package:Chem", unload = TRUE)
install_github("gindeanikita/Chem", force = TRUE)
install_github("gindeanikita/Chem", force = TRUE)
library(Chem)
webSDF <- function(query, origin = "PubChem", saveFile = FALSE){
if(origin == "PubChem"){
w1 <- "https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name"
w2 <- "sdf"
link <- paste(w1, query, w2, sep = "/")
sdfExport <- readLines(link)
}
sdfAdjusted <- Chem::sdfAdjust(sdfExport, origin = "txt",
saveNewFile = saveFile,
newFileName = paste(query, ".sdf"))
return(sdfAdjusted)
}
sdfAdjust <- function(sdfFile, origin = "file", directory = getwd(),
saveNewFile = FALSE,
newFileName = paste(getwd(), "/", sdfFile,
"_Adjusted.sdf", sep = "")) {
#--- If directory not specified it reads from active working directory
#--- By default saveNewFile is FALSE
#--- By default newFileName is <sdFileName>_Treated.sdf
#--- It is possible to import function return into a ChemmineR SDFset
#--- Importing to rcdk it is possible through saving and importing file
if (origin == "file") {
sdfText <- readLines(paste(directory, sdfFile, sep = "/"), n = -1)
} else {
sdfText <- sdfFile
}
nPosM_END <- c(1, grep("\\$$$$", sdfText))
nCharStr <- "QWERTYUIOPASDFGHJKLZXCVBNM0123456789"
nNewMol <- numeric(0)
for (M_END in 2:length(nPosM_END)) {
nMolSeq <- sdfText[(nPosM_END[M_END - 1]+1):nPosM_END[M_END]]
nPosCLB <- grep("V", nMolSeq)                                #Count Line Block
nCLB <- c("", nMolSeq[nPosCLB[1]])
nWordHB <- Chem::hasCharacter(nMolSeq, nCharStr)
nPosWordHB <- nWordHB[1]
if (nPosWordHB != 1) {
nHB <- nMolSeq[(nPosWordHB - 1):nPosWordHB]
} else {
nHB <- c("", nMolSeq[nPosWordHB])
}
nNewMol <- c(nNewMol, nHB, nCLB, nMolSeq[(nPosCLB[1] + 1):length(nMolSeq)])
}
if (saveNewFile == TRUE) {
write(nNewMol, file = paste(directory, newFileName, sep = "/"))
}
return(nNewMol)
}
#-------------------------------------------------------------------------------
#--- Trying to read a sdf file from PubChem
sdfPC <- webSDF("Methotrexate", saveFile = TRUE)
webSDF <- function(query, origin = "PubChem", saveFile = FALSE){
if(origin == "PubChem"){
w1 <- "https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name"
w2 <- "sdf"
link <- paste(w1, query, w2, sep = "/")
sdfExport <- readLines(link)
}
sdfAdjusted <- sdfAdjust(sdfExport, origin = "txt",
saveNewFile = saveFile,
newFileName = paste(query, ".sdf"))
return(sdfAdjusted)
}
#-------------------------------------------------------------------------------
#--- Trying to read a sdf file from PubChem
sdfPC <- webSDF("Methotrexate", saveFile = TRUE)
webSDF <- function(query, origin = "PubChem", saveFile = FALSE){
if(origin == "PubChem"){
w1 <- "https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name"
w2 <- "sdf"
link <- paste(w1, query, w2, sep = "/")
sdfExport <- readLines(link)
}
sdfAdjusted <- sdfAdjust(sdfExport, origin = "txt",
saveNewFile = saveFile,
newFileName = paste(query, ".sdf", sep = ""))
return(sdfAdjusted)
}
#-------------------------------------------------------------------------------
#--- Trying to read a sdf file from PubChem
sdfPC <- webSDF("Methotrexate", saveFile = TRUE)
dfsdfPC_rcdk <- load.molecules("Methotrexate.sdf")
dfsdfPC_CheR <- read.SDFset("Methotrexate.sdf")
dfsdfPC_rcdk_fps <- get.fingerprint(dfsdfPC_rcdk, type = "maccs")
View(dfCMP_crr_rcdk)
View(dfsdfPC_rcdk)
dfsdfPC_rcdk_fps <- get.fingerprint(dfsdfPC_rcdk[[1]], type = "maccs")
webSDF <- function(query, origin = "PubChem", saveFile = FALSE){
if(origin == "PubChem"){
w1 <- "https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/name"
w2 <- "sdf"
link <- paste(w1, query, w2, sep = "/")
sdfExport <- readLines(link)
}
sdfAdjusted <- sdfAdjust(sdfExport, origin = "txt",
saveNewFile = saveFile,
newFileName = paste(query, ".sdf", sep = ""))
return(sdfAdjusted)
}
sdfAdjust <- function(sdfFile, origin = "file", directory = getwd(),
saveNewFile = FALSE,
newFileName = paste(getwd(), "/", sdfFile,
"_Adjusted.sdf", sep = "")) {
#--- If directory not specified it reads from active working directory
#--- By default saveNewFile is FALSE
#--- By default newFileName is <sdFileName>_Treated.sdf
#--- It is possible to import function return into a ChemmineR SDFset
#--- Importing to rcdk it is possible through saving and importing file
if (origin == "file") {
sdfText <- readLines(paste(directory, sdfFile, sep = "/"), n = -1)
} else {
sdfText <- sdfFile
}
nPosM_END <- c(1, grep("\\$$$$", sdfText))
nCharStr <- "QWERTYUIOPASDFGHJKLZXCVBNM0123456789"
nNewMol <- numeric(0)
for (M_END in 2:length(nPosM_END)) {
nMolSeq <- sdfText[(nPosM_END[M_END - 1]+1):nPosM_END[M_END]]
nPosCLB <- grep("V", nMolSeq)                                #Count Line Block
nCLB <- c("", nMolSeq[nPosCLB[1]])
nWordHB <- Chem::hasCharacter(nMolSeq, nCharStr)
nPosWordHB <- nWordHB[1]
if (nPosWordHB != 1) {
nHB <- nMolSeq[(nPosWordHB - 1):nPosWordHB]
} else {
nHB <- c("", nMolSeq[nPosWordHB])
}
nNewMol <- c(nNewMol, nHB, nCLB, nMolSeq[(nPosCLB[1] + 1):length(nMolSeq)])
}
if (saveNewFile == TRUE) {
write(nNewMol, file = paste(directory, newFileName, sep = "/"))
}
return(nNewMol)
}
#-------------------------------------------------------------------------------
#--- Trying to read a sdf file from PubChem
sdfPC <- webSDF("Methotrexate", saveFile = TRUE)
dfsdfPC_rcdk <- load.molecules("Methotrexate.sdf")
dfsdfPC_rcdk_fps <- get.fingerprint(dfsdfPC_rcdk[[1]], type = "maccs")
dfsdfPC_CheR <- read.SDFset("Methotrexate.sdf")
dfsdfPC_CheR_fps <- fingerprintOB(dfsdfPC_CheR, "FP2")
View(dfsdfPC_CheR)
View(dfsdfPC_CheR_fps)
sdfPC <- webSDF("Aspirin", saveFile = TRUE)
dfsdfPC_rcdk <- load.molecules("Aspirin.sdf")
dfsdfPC_rcdk_fps <- get.fingerprint(dfsdfPC_rcdk[[1]], type = "maccs")
dfsdfPC_CheR <- read.SDFset("Aspirin.sdf")
dfsdfPC_CheR_fps <- fingerprintOB(dfsdfPC_CheR, "FP2")
